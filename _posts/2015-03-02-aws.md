---
layout: post
title:  "AWS"
date:   2015-03-02 07:24:32
categories: devops
description: Frequently used services in AWS, their purpose, features and differences
---

* __ELB__
  * Multiple EC2 instances in different zones
  * Same CNAME
  * We need to define what healthy means
  * Healthcheck configuration

* __Access to an instance__
  * You lose access, if you lose the private key

* __Route 53__
  * DNS Service
  * Provides secure reliable routing to instances
  * Update name servers & record sets for hosted zones
  * Maintains hosted zones which is a collection of resource record sets
  * DNS takes time to propagate

* __Update an Ubuntu EC2 instance__
  * Create an AMI(full carbon copy) of the existing server
  * `sudo do-release-upgrade`
  * If anything fails launch the newly created AMI and reassociate the elastic IP

* __EBS__
  * EBS provides persistent storage
  * EBS has volumes. 
  * Volumes are like virtual hard drives. They can be attached to or detached from instances
  * A volume can only be attached to 1 instance at a time
  * Volumes can have snapshots and can be restored to a particular snapshot

* __EBS backed instance__
  * When the instance loads up, it loads the root file system onto a new EBS volume
  * Layering of the EC2 virtual machine technology over EBS virtual hard drive technology
  * The instance is a volume itself

* __Snapshots & Restoration__
  * AMI: An EBS volume that contains an OS, file system, kernel, applications & everything to boot up
  *  EBS: is like a hard disk drive volume. Rent many EBS volums, add files and mount on your instance
  * Instance: Complete virtual machine. Everytime you launch an AMI, you get to chose its virtual hardware. 
  * Root Device: EBS volume used to boot up the instance
  * Snapshot: Copy of your EBS volume. Virtual hard disk. You take a snapshot. Amazon converts it into AMI

* __CLI__
  * CLI is written in python
  * Uses JMESPATH - open source query language for json
  * Command Structure - `aws ec2 describe-instances`
  * `aws service Command Operation`
  * `--output JSON` - Specify Output
  * Types - Text/JSON/Table. Default - JSON
  * JSON is great for programmatic use. Text is good to be used in conjunction with grep etc
  * You can set a profile & run commands within that profile
  * Step-1: Installation
  * Step-2: Configuration
  * `aws configure` - Asks 4 questions. Access Key, Secret Access Key, Region, Output Format
  * Behind the scenes, it sends a http request, parse the response
  * Apply query to the response

* CLI Configuration 
  * `aws configure list`
  * `aws configure get region`
  * Profile is a set of configuration values
  * `aws configure set profile.prod.region us-west-2` - Also sets the profile to prod
  * `--profile prod` - set the flag to prod
  * `~/.aws/credentials`  `~/.aws/config` - Location of files
  * To apply query `--query`
  * `wait` commands

* __Resources__
  * https://gist.github.com/evandbrown/327a288ac719e69254ff

* __EB Command Reference__
  * Most Used
    * `eb create env-1` - creates a new env and deploys the current app
    * `eb deploy env-1` - creates a zip file of project to the running application
  * Others
    * `eb clone` - clones an env to a new env so they have identical settings
    * `eb config env_name` - To edit the env config settings
    * `eb config list`
    * `eb events` - plenty of useful info on the bucket, security group
    * `eb health env_name`
    * `eb init` - set default values for eb applications
    * `eb list` - list of all environment names. Current env is marked with an asterisk
    * `eb local run`
    * `eb logs`
    * `eb platform list`
    * `eb platform show`
    * `eb printenv env_name`
    * `eb setenv env_name`
    * `eb ssh env_name`
    * `eb swap`
    * `eb use`